# Railway System Deployment on Render (Unified + Free Tier + SQLite)

This guide will help you deploy the Indian Railways Track Fittings Management System on Render.com as a **UNIFIED APPLICATION** using the **FREE TIER** with SQLite database.

## ðŸš€ Prerequisites

1. **Render Account**: Sign up at [render.com](https://render.com)
2. **GitHub Repository**: Push your code to GitHub

## ðŸ“‹ Deployment Steps

### Step 1: Prepare Your Repository

1. **Push to GitHub**:
   ```bash
   git add .
   git commit -m "Add Render deployment configuration"
   git push origin main
   ```

2. **Verify Files**: Ensure these files are in your repository:
   - `render.yaml` (in root directory)
   - `main.py` (unified application)
   - `requirements.txt` (in root directory)
   - `build.sh` (build script)
   - `backend/app/` (backend code)
   - `frontend/package.json` (frontend code)

### Step 2: Deploy Using Blueprint

1. **Connect GitHub**:
   - Go to [render.com](https://render.com)
   - Click "New +" â†’ "Blueprint"
   - Connect your GitHub repository
   - Select your repository

2. **Deploy Blueprint**:
   - Render will detect the `render.yaml` file
   - Review the service configuration:
     - **Unified Service**: Single Python web service serving both API and frontend
   - Click "Apply" to create the service

### Step 3: Manual Service Creation (Alternative)

If you prefer manual setup:

#### Create Unified Service:
1. Click "New +" â†’ "Web Service"
2. Connect your GitHub repository
3. Configure:
   - **Name**: `railway-system`
   - **Environment**: `Python 3`
   - **Build Command**: `./build.sh && pip install -r requirements.txt`
   - **Start Command**: `python main.py`
   - **Root Directory**: (leave empty - uses root)

### Step 4: Environment Variables

The `render.yaml` file automatically configures most environment variables, but you can customize them:

#### Backend Environment Variables:
```bash
DATABASE_URL=sqlite:///./railway_fittings.db
SECRET_KEY=<auto-generated>
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
DEBUG=false
CORS_ORIGINS=https://railway-frontend.onrender.com
ALLOWED_HOSTS=railway-backend.onrender.com
```

#### Frontend Environment Variables:
```bash
REACT_APP_API_URL=https://railway-backend.onrender.com
REACT_APP_APP_NAME=Railway Fittings Management System
```

## ðŸ”§ Configuration Details

### Backend Service
- **Runtime**: Python 3.11
- **Database**: SQLite (file-based, no external database needed)
- **API**: FastAPI with automatic documentation
- **Static Files**: QR codes stored in `/static/qr_codes`

### Frontend Service
- **Runtime**: Static site (React build)
- **Build**: npm install && npm run build
- **Serving**: Static files with client-side routing

### Database
- **Type**: SQLite (embedded database)
- **Location**: `./railway_fittings.db` in backend service
- **Persistence**: Data persists between deployments
- **Backup**: Automatic with service restarts

## ðŸš¨ Troubleshooting

### Common Issues

1. **Build Failures**:
   ```bash
   # Check build logs in Render dashboard
   # Common fixes:
   - Update requirements.txt
   - Check Python version compatibility
   - Verify file paths
   ```

2. **Database Issues**:
   ```bash
   # SQLite database is created automatically
   # Check if static directory exists
   # Verify file permissions
   ```

3. **CORS Issues**:
   ```bash
   # Update CORS_ORIGINS environment variable
   # Include your frontend URL
   ```

4. **Static Files Not Loading**:
   ```bash
   # Check if static directories exist
   # Verify file paths in backend
   # Check nginx configuration
   ```

### Performance Optimization

1. **SQLite Optimization**:
   - Database is file-based and fast for small to medium datasets
   - No connection pooling needed
   - Automatic indexing

2. **Static File Serving**:
   - QR codes served directly from backend
   - Frontend assets cached by CDN

## ðŸ“Š Monitoring

### Health Checks
- **Backend**: `GET /` returns 200 OK
- **Frontend**: Static files serve correctly
- **Database**: SQLite file accessible

### Logs
- View logs in Render dashboard
- Monitor error rates
- Track performance metrics

## ðŸ”’ Security Considerations

### Production Security
1. **Environment Variables**:
   - SECRET_KEY is auto-generated
   - Never commit secrets to repository

2. **CORS Configuration**:
   - Restricted to your frontend domain
   - No wildcard (*) in production

3. **Database Security**:
   - SQLite file is private to the service
   - No external database connections

## ðŸ’° Free Tier Configuration

### âœ… What's Included in Free Tier:
- **Web Services**: 750 hours/month (31 days = 744 hours)
- **Static Sites**: Unlimited bandwidth and builds
- **Build Time**: 90 minutes per month
- **Sleep Mode**: Services sleep after 15 minutes of inactivity
- **Total Cost**: **$0** - Completely free!

### âš ï¸ Free Tier Limitations:
- **Sleep Mode**: Services wake up when accessed (takes ~30 seconds)
- **Build Time**: Limited to 90 minutes per month
- **Memory**: 512MB RAM per service
- **CPU**: Shared resources
- **Custom Domains**: Not available on free tier

### ðŸ’¡ Free Tier Optimization:
- **SQLite Database**: No external database costs
- **Static Frontend**: Unlimited bandwidth
- **Efficient Builds**: Optimized build commands
- **Auto-sleep**: Saves resources when not in use

## ðŸš€ Going Live

1. **Test Everything**:
   - Test all API endpoints
   - Verify frontend functionality
   - Check database operations

2. **Free Tier Considerations**:
   - Services will sleep after 15 minutes of inactivity
   - First request after sleep takes ~30 seconds to wake up
   - Perfect for development, testing, and low-traffic applications
   - No custom domains on free tier (use .onrender.com URLs)

3. **Monitor**:
   - Watch for errors in Render dashboard
   - Monitor build time usage (90 minutes/month limit)
   - Check service uptime and sleep patterns

## ðŸ“ž Support

- **Render Documentation**: [render.com/docs](https://render.com/docs)
- **Community Forum**: [community.render.com](https://community.render.com)

---

## ðŸŽ¯ Quick Start Checklist

- [ ] Push code to GitHub
- [ ] Create Render account (free)
- [ ] Deploy using Blueprint (free tier)
- [ ] Test backend API
- [ ] Test frontend
- [ ] Understand sleep mode behavior
- [ ] Go live!

Your Railway Fittings Management System should now be running on Render **FREE TIER** with SQLite! ðŸš‚

## ðŸ’¡ Pro Tips for Free Tier:

1. **First Load**: Expect ~30 second delay when services wake from sleep
2. **Development**: Perfect for testing and development
3. **Builds**: Monitor your 90-minute monthly build limit
4. **Sleep Mode**: Services automatically sleep to save resources
5. **No Database Costs**: SQLite eliminates external database fees

## ðŸ”‘ Demo Credentials:

- **Admin**: `admin` / `admin123`
- **Inspector**: `inspector1` / `insp123`
- **Depot Manager**: `depot_manager` / `depot123`
- **Vendor Rep**: `vendor_rep` / `vendor123`

> **Note**: This demo uses simplified password hashing (SHA-256 with salt) for compatibility. In production, use bcrypt or argon2 for better security.